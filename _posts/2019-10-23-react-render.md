---
layout: post
title: 'redux渲染机制'
date: '2020-01-14'
tags: 'react'
author: 'guozhaodong'
---

# redux渲染机制

> 本文主要讲解，react在执行`render`方法后，其内部到底发生了什么，界面是如何变化的。

### `Reconciliation`与`Diffing`算法简介

`Reconciliation`可以叫调和或者协调，意为通过虚拟dom前后对比，计算出哪部分dom需要删除，哪部分需要新增，哪部分需要移动或者更新的这个过程。其核心的算法就叫做`diffing`算法。

对于生成一棵树转换成另一颗树的最小操作数，目前业界有一些通用的解决方案，但是即使是最优的算法其复杂度也是O(n <sup>3</sup>)，然而`diffing`算法将其复杂度降到了O(n)。


### `Diffing` 算法

`Diffing` 算法主要是基于以下两个前提：

1. 两个不同类型的元素会产生出不同的树。

2. 开发者可以通过 `key` `prop` 来暗示哪些子元素在不同的渲染下能保持稳定。

基于第一点我们可以得出结论，`Diffing`算法只会对同层级的节点进行比较，如下图

![image](/assets/img/react-render/640.jpg)

也就是说如果父节点不相同，`React`不会再去对比其子节点，这也就提高了对比的效率。

下面我们就几种情况来具体看下`Diffing`算法是如何做的

#### 比对不同类型的元素

对于不同类型的元素，`React`直接将其删除，重新建立一个新的节点树，看下面例子



#### 比对同一类型的元素

#### 比对同类型的组件元素

#### 对子节点进行递归

#### Keys




